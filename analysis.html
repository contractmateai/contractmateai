<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>SignSense — Analysis</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <style>
    :root{
      --bg:#0e0c13;
      --card:#1c1b22;
      --border:#3b3b3b;
      --white:#ffffff;
      --muted:#bdbdbd;
      --green:#00ff65;
      --orange:#df911a;
      --red:#fe0000;
      --black:#000000;
      --radius:21px;
      --gap:18px;
      --rail:58px;       /* fixed mini-rail */
      --drawerW:75vw;    /* mobile drawer width = 75% of screen */
      --sidebarW:300px;  /* desktop sidebar width */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--white);font:400 16px/1.7 Inter,system-ui,Segoe UI,Roboto,Arial}

    /* ===== MINI LEFT RAIL (always fixed) ===== */
    .rail{
      position:fixed; left:0; top:0; bottom:0; width:var(--rail);
      background:#0f0e14; border-right:1px solid var(--border);
      display:flex; flex-direction:column; align-items:center; gap:16px; padding:10px 0;
      z-index:50;
    }
    .rail .brand{
      display:flex; align-items:center; justify-content:center; height:54px; width:100%;
    }
    .rail .brand img{width:28px; height:28px}
    .rail .menu-btn{
      display:flex; align-items:center; justify-content:center;
      width:42px; height:42px; border-radius:12px; border:1px solid var(--border);
      background:#14121a; cursor:pointer;
    }
    .rail .stack{
      margin-top:8px; display:flex; flex-direction:column; gap:14px; align-items:center; width:100%;
    }
    .rail .stack a, .rail .stack button{
      display:flex; align-items:center; justify-content:center; width:42px; height:42px;
      background:#14121a; border:1px solid var(--border); border-radius:14px; text-decoration:none;
      cursor:pointer;
    }
    .rail .stack img{width:22px; height:22px}

    /* ===== DRAWER (mobile) / SIDEBAR (desktop) ===== */
    .drawer{
      position:fixed; left:0; top:0; bottom:0; width:var(--drawerW); max-width:420px;
      background:#0f0e14; border-right:1px solid var(--border);
      display:flex; flex-direction:column; padding:12px 16px 16px; gap:16px;
      transform:translateX(calc(-1 * var(--drawerW))); transition:transform .28s ease; z-index:80;
    }
    .drawer.open{ transform:translateX(0) }
    .drawer .brand-row{ display:flex; align-items:center; gap:12px; padding:4px 6px 0 6px; }
    .drawer .brand-row img{width:34px; height:34px}
    .drawer .brand-row span{font-size:24px; font-weight:400}
    .drawer .nav{display:flex; flex-direction:column; gap:10px; margin-top:6px}
    .drawer .nav a{
      text-decoration:none; color:var(--muted); display:flex; align-items:center; gap:16px;
      padding:16px 18px; border-radius:16px; border:1px solid transparent; font-size:19px;
    }
    .drawer .nav a img.icon{width:26px; height:26px}
    .drawer .nav a img.arr{width:18px; height:18px; opacity:.9}
    .drawer .nav a.active{background:#181620; border:1px solid var(--border); color:var(--white)}
    .drawer .nav a:hover{background:transparent; border:1px solid var(--border); color:var(--white)}
    .drawer .push{flex:1}
    .drawer .end{color:var(--muted); font-size:15px; line-height:1.6}
    .drawer .footer-sep{height:1px; background:var(--border); margin:10px 0}

    /* Overlay when drawer open */
    .scrim{
      position:fixed; inset:0; background:rgba(0,0,0,.45); opacity:0; visibility:hidden;
      transition:opacity .25s ease, visibility .25s ease; z-index:70;
    }
    .scrim.show{opacity:1; visibility:visible}

    /* ===== MAIN CONTENT ===== */
    .page{
      display:grid; grid-template-columns:1fr; min-height:100vh;
      padding-left:var(--rail);
    }
    .topbar{
      position:sticky; top:0; z-index:40; background:var(--bg);
      display:flex; align-items:flex-end; justify-content:space-between;
      padding:10px 12px 12px; height:64px; border-bottom:1px solid var(--border);
    }
    .top-title{font-size:20px; font-weight:400}

    /* Language dropdown */
    .lang{position:relative}
    .lang-btn{
      display:flex; align-items:center; gap:8px; background:transparent; border:none; color:var(--white);
      font:400 20px/1 Inter; cursor:pointer; padding:6px 10px; min-width:40px; user-select:none;
    }
    .lang-btn .caret{width:0;height:0;border-left:6px solid transparent;border-right:6px solid transparent;border-top:7px solid #fff;opacity:.9}
    .lang-menu{
      position:absolute; right:0; top:calc(100% + 8px); background:var(--card); border:1px solid var(--border);
      border-radius:12px; min-width:240px; max-height:240px; overflow:auto; display:none; box-shadow:0 10px 30px rgba(0,0,0,.4); padding:6px;
      scrollbar-width:thin; scrollbar-color:#6a6a6a transparent;
    }
    .lang-menu::-webkit-scrollbar{width:6px}
    .lang-menu::-webkit-scrollbar-thumb{background:#6a6a6a;border-radius:10px}
    .lang:hover .lang-menu, .lang.open .lang-menu{display:block}
    .lang-item{display:flex;align-items:center;gap:8px;padding:10px;border-radius:10px;color:var(--white);cursor:pointer}
    .lang-item:hover{background:#17161e}

    /* Grid/cards */
    .main{padding:0 16px 140px}
    .grid{display:grid; grid-template-columns:1fr; gap:var(--gap); align-items:start; margin-top:12px}
    .card{
      background:var(--card); border:1px solid var(--border); border-radius:var(--radius); padding:18px 18px 20px;
      opacity:0; transform:translateY(8px);
    }
    @keyframes fadeIn{to{opacity:1; transform:translateY(0)}}
    .fade-in{animation:fadeIn .8s ease forwards}

    .card h3{margin:0 0 16px;display:flex;align-items:center;gap:12px;font-size:20px;font-weight:400}
    .card h3 img{width:24px;height:24px}
    .list{display:flex;flex-direction:column;gap:12px}
    .list p{margin:0;color:var(--muted);font-size:16px;overflow-wrap:anywhere}

    .bullets{margin:0;color:var(--muted);font-size:16px;padding-left:22px;list-style:disc}
    .bullets li{margin:0 0 10px}

    .numbered{counter-reset:item}
    .numbered p{position:relative;padding-left:26px;margin:0 0 10px}
    .numbered p::before{counter-increment:item;content:counter(item) ".";position:absolute;left:0;top:0;color:var(--muted)}

    /* Meters */
    .meter-block{display:flex;flex-direction:column;gap:10px}
    .meter-head{display:flex;align-items:center;justify-content:space-between}
    .meter-title{display:flex;align-items:center;gap:10px;font-size:18px}
    .meter-title img{width:22px;height:22px}
    .meter{height:10px;border-radius:999px;background:var(--black);overflow:hidden}
    .fill{height:100%;width:0%;transition:width 1.6s ease;border-radius:999px}

    /* Donuts (mobile sized) */
    .hcard{display:flex;gap:14px;align-items:center}
    .circle{width:120px;height:120px;position:relative;display:grid;place-items:center;flex:0 0 120px}
    .circle svg{transform:rotate(-90deg)}
    .circle .val{position:absolute;font-weight:400;font-size:28px}
    .circle circle.track{stroke:var(--black);stroke-width:10;fill:none}
    .circle circle.arc{stroke-width:10;fill:none;stroke-linecap:round;stroke-dasharray:440;stroke-dashoffset:440}
    .htext{flex:1;display:flex;flex-direction:column;gap:6px}
    .muted{color:var(--muted);font-size:15px}
    .status{display:flex;align-items:center;gap:8px;margin-top:6px}
    .status .dot{width:10px;height:10px;border-radius:2px;background:var(--green)}
    .status span{font-size:15px}

    /* Score checker */
    #scoreCard .score-center{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;text-align:center}
    #scoreCard .score-pct{font-size:32px}
    .score-side{flex:1;display:flex;flex-direction:column;gap:12px}
    .score-remark{font-size:16px;color:var(--muted)}
    .score-bar{position:relative;height:20px;border-radius:14px;background:linear-gradient(90deg,#ff6b6b 0%, #ffd166 45%, #00e676 100%);border:1px solid #2f2f2f;box-shadow:inset 0 1px 0 rgba(255,255,255,.05);width:100%}
    .score-ind{position:absolute;top:-6px;height:30px;width:3px;background:#fff;border-radius:2px;left:calc(80% - 1.5px);box-shadow:0 0 8px rgba(255,255,255,.6)}
    .score-scale{display:flex;justify-content:space-between;font-size:14px;color:var(--muted)}

    /* Download CTA */
    .download-wrap{position:fixed;left:var(--rail);right:0;bottom:28px;display:none;justify-content:center;z-index:60;opacity:0;transform:translateY(8px)}
    .download{background:#f2f9fe;color:#000;border:1px solid #cfcfcf;border-radius:16px;padding:16px 26px;display:inline-flex;gap:12px;align-items:center;cursor:pointer;font-weight:400;font-size:18px;box-shadow:0 6px 28px rgba(0,0,0,.28)}
    .download:hover{filter:brightness(1.03)}

    /* Modal */
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:100}
    .modal-card{background:#141319;border:1px solid var(--border);border-radius:18px;padding:18px;width:min(480px,92vw)}
    .modal-card h4{margin:0 0 10px;font-size:18px;font-weight:400}
    .modal-row{display:flex;gap:10px;margin-top:12px}
    .input{flex:1;background:#0f0e14;border:1px solid #5a5a5a;border-radius:10px;padding:12px;color:#fff;font:400 15px/1 Inter}
    .btn{background:#0f0e14;border:1px solid var(--border);color:#fff;border-radius:10px;padding:12px 14px;cursor:pointer}
    .btn.primary{background:#f2f9fe;color:#000;border-color:#cfcfcf}

    /* ===== DESKTOP ===== */
    @media (min-width:1100px){
      .rail{ display:none; }
      .scrim{ display:none !important; }
      .drawer{
        position:sticky; transform:none !important; width:var(--sidebarW); max-width:var(--sidebarW);
        top:0; height:100vh; z-index:20;
      }
      .page{ grid-template-columns:var(--sidebarW) 1fr; padding-left:0; }
      .main{ padding:0 20px 140px; }
      .grid{ grid-template-columns:minmax(560px,1.25fr) minmax(560px,1fr); }
      .download-wrap{ left:var(--sidebarW); }
      .card h3{ font-size:24px }
      .bullets, .list p{ font-size:18px }
      .meter-title{ font-size:20px }
      .circle{ width:160px; height:160px } .circle .val{ font-size:34px }
      .score-remark{ font-size:20px } .score-pct{ font-size:42px }
    }
  </style>
</head>
<body>
  <!-- FIXED MINI-RAIL -->
  <aside class="rail" aria-label="Quick navigation">
    <div class="brand"><img src="https://imgur.com/Z5hv7K9.png" alt="SignSense"></div>
    <button id="menuBtn" class="menu-btn" aria-label="Open menu"><img src="https://imgur.com/CHGomYz.png" alt="" width="20" height="20"></button>
    <div class="stack">
      <a href="#" aria-label="Overview"><img src="https://imgur.com/lnQTDuo.png" alt=""></a>
      <a href="index.html" aria-label="Home"><img src="https://imgur.com/kE3okdE.png" alt=""></a>
      <a href="privacy.html" aria-label="Privacy"><img src="https://imgur.com/krMnFVT.png" alt=""></a>
      <a href="#" aria-label="Contact"><img src="https://imgur.com/6zHviT6.png" alt=""></a>
      <a href="#" id="leaveReviewRail" aria-label="Leave Review"><img src="https://imgur.com/zwr9SOe.png" alt=""></a>
    </div>
  </aside>

  <!-- DRAWER + OVERLAY -->
  <div id="scrim" class="scrim" aria-hidden="true"></div>
  <aside id="drawer" class="drawer" aria-label="Menu" aria-hidden="true">
    <div class="brand-row">
      <img src="https://imgur.com/Z5hv7K9.png" alt="">
      <span>SignSense</span>
    </div>

    <nav class="nav">
      <a class="active" href="#"><img class="arr" src="https://imgur.com/CHGomYz.png" alt=""><img class="icon" src="https://imgur.com/lnQTDuo.png" alt=""><span>Overview</span></a>
      <a href="index.html"><img class="arr" src="https://imgur.com/xhkeG0y.png" alt=""><img class="icon" src="https://imgur.com/kE3okdE.png" alt=""><span>Home</span></a>
      <a href="privacy.html"><img class="arr" src="https://imgur.com/xhkeG0y.png" alt=""><img class="icon" src="https://imgur.com/krMnFVT.png" alt=""><span>Privacy</span></a>
      <a href="#"><img class="arr" src="https://imgur.com/xhkeG0y.png" alt=""><img class="icon" src="https://imgur.com/6zHviT6.png" alt=""><span>Contact Us</span></a>
      <a href="#" id="leaveReview"><img class="arr" src="https://imgur.com/xhkeG0y.png" alt=""><img class="icon" src="https://imgur.com/zwr9SOe.png" alt=""><span>Leave a Review</span></a>
    </nav>

    <div class="push"></div>
    <div class="end">
      <div>All rights reserved.</div>
      <div>© 2025 SignSense</div>
      <div class="footer-sep"></div>
      <div>Not legal advice.<br/>For informational use only.</div>
    </div>
  </aside>

  <!-- PAGE (desktop also uses drawer as sidebar) -->
  <div class="page">
    <!-- empty column is the drawer in desktop; content is always last col -->
    <main class="main">
      <div class="topbar">
        <div class="top-left"><div class="top-title">Overview</div></div>
        <div class="lang" id="lang">
          <button class="lang-btn" id="langBtn" type="button">
            <span id="langNow">EN</span><span class="caret" aria-hidden="true"></span>
          </button>
          <div class="lang-menu" id="langMenu" role="listbox" aria-label="Report Language">
            <div class="lang-item" data-lang="English">English</div>
            <div class="lang-item" data-lang="Italiano">Italiano</div>
            <div class="lang-item" data-lang="Deutsch">Deutsch</div>
            <div class="lang-item" data-lang="Español">Español</div>
            <div class="lang-item" data-lang="Français">Français</div>
            <div class="lang-item" data-lang="Português">Português</div>
            <div class="lang-item" data-lang="Nederlands">Nederlands</div>
            <div class="lang-item" data-lang="Română">Română</div>
            <div class="lang-item" data-lang="Shqip">Shqip</div>
            <div class="lang-item" data-lang="Türkçe">Türkçe</div>
            <div class="lang-item" data-lang="中文">中文</div>
            <div class="lang-item" data-lang="日本語">日本語</div>
          </div>
        </div>
      </div>

      <div class="grid">
        <!-- LEFT COLUMN -->
        <div class="left">
          <section class="card" id="summaryCard">
            <h3><img src="https://imgur.com/CuQFbD7.png" alt="">Summary</h3>
            <div class="list" id="summaryText"></div>
          </section>

          <section class="card meter-block" id="profCard">
            <div class="meter-head">
              <div class="meter-title"><img src="https://imgur.com/EdMAMnx.png" alt=""><span>Professionalism</span></div>
              <div id="confVal">0%</div>
            </div>
            <div class="meter"><div id="confFill" class="fill"></div></div>
          </section>

          <section class="card meter-block" id="favCard">
            <div class="meter-head">
              <div class="meter-title"><img src="https://imgur.com/UDRuIvO.png" alt=""><span>Favorability Index</span></div>
              <div id="favVal">0%</div>
            </div>
            <div class="meter"><div id="favFill" class="fill"></div></div>
          </section>

          <section class="card meter-block" id="deadCard">
            <div class="meter-head">
              <div class="meter-title"><img src="https://imgur.com/VXZ3kD8.png" alt=""><span>Deadline pressure</span></div>
              <div id="deadVal">0%</div>
            </div>
            <div class="meter"><div id="deadFill" class="fill"></div></div>
          </section>

          <section class="card" id="issuesCard">
            <h3><img src="https://imgur.com/ppLDtiq.png" alt="">Potential Issues</h3>
            <ul class="bullets" id="issuesList"></ul>
          </section>

          <section class="card" id="suggestionsCard">
            <h3><img src="https://imgur.com/EoVDfd5.png" alt="">Smart Suggestions</h3>
            <div class="list numbered" id="suggestionsList"></div>
          </section>
        </div>

        <!-- RIGHT COLUMN -->
        <div class="right">
          <section class="card" id="riskCard">
            <div class="hcard">
              <div class="circle">
                <svg width="120" height="120" viewBox="0 0 160 160">
                  <circle class="track" cx="80" cy="80" r="74"></circle>
                  <circle id="riskArc" class="arc" cx="80" cy="80" r="74"></circle>
                </svg>
                <div class="val" id="riskVal">0%</div>
              </div>
              <div class="htext">
                <h3 style="margin-bottom:0"><img src="https://imgur.com/Myp6Un4.png" alt="">Risk Level</h3>
                <div class="muted" id="riskNote"></div>
                <div class="status"><span class="dot" id="riskDot"></span><span id="riskBadge">Generally Safe</span></div>
              </div>
            </div>
          </section>

          <section class="card" id="clarCard">
            <div class="hcard">
              <div class="circle">
                <svg width="120" height="120" viewBox="0 0 160 160">
                  <circle class="track" cx="80" cy="80" r="74"></circle>
                  <circle id="clarArc" class="arc" cx="80" cy="80" r="74"></circle>
                </svg>
                <div class="val" id="clarVal">0%</div>
              </div>
              <div class="htext">
                <h3 style="margin-bottom:0"><img src="https://imgur.com/o39xZtC.png" alt="">Clause Clarity</h3>
                <div class="muted" id="clarNote"></div>
                <div class="status"><span class="dot" id="clarDot"></span><span id="clarBadge">Generally Safe</span></div>
              </div>
            </div>
          </section>

          <section class="card" id="clausesCard">
            <h3><img src="https://imgur.com/K04axKU.png" alt="">Main Clauses</h3>
            <div class="list numbered" id="clausesList"></div>
          </section>

          <section class="card" id="scoreCard">
            <div class="hcard">
              <div class="circle">
                <svg width="120" height="120" viewBox="0 0 160 160">
                  <circle class="track" cx="80" cy="80" r="74"></circle>
                  <circle id="scoreArc" class="arc" cx="80" cy="80" r="74"></circle>
                </svg>
                <div class="score-center">
                  <div class="score-pct" id="scorePct">80%</div>
                </div>
              </div>
              <div class="score-side">
                <h3 style="margin-bottom:0"><img src="https://imgur.com/mFvyCj7.png" alt="">Score Checker</h3>
                <div class="score-remark">The contract is nearly perfectly done.</div>
                <div class="score-bar"><span class="score-ind" id="scoreInd"></span></div>
                <div class="score-scale"><span>Unsafe</span><span>Safe</span><span>Very Safe</span></div>
              </div>
            </div>
          </section>

          <section class="card meter-block" id="confRightCard">
            <div class="meter-head">
              <div class="meter-title"><img src="https://imgur.com/nUGfg96.png" alt=""> <span>Confidence to sign freely</span></div>
              <div id="conf2Val">0%</div>
            </div>
            <div class="meter"><div id="conf2Fill" class="fill"></div></div>
          </section>
        </div>
      </div>
    </main>
  </div>

  <!-- Download -->
  <div class="download-wrap" id="dlWrap">
    <button class="download" id="downloadBtn">Download Report</button>
  </div>

  <!-- Email modal -->
  <div class="modal" id="emailModal" aria-modal="true" role="dialog">
    <div class="modal-card">
      <h4>Enter your email to download the PDF report</h4>
      <div class="modal-row">
        <input id="emailInput" class="input" type="email" inputmode="email" placeholder="you@example.com" />
        <button class="btn primary" id="emailSubmit">Download</button>
        <button class="btn" id="emailCancel">Cancel</button>
      </div>
      <div id="emailErr" style="color:#ff6b6b;font-size:13px;margin-top:8px;display:none">Please enter a valid email address.</div>
    </div>
  </div>

<script>
(() => {
  /* ---------- Drawer interactions ---------- */
  const drawer = document.getElementById('drawer');
  const scrim  = document.getElementById('scrim');
  const menuBtn = document.getElementById('menuBtn');

  function openDrawer(){
    drawer.classList.add('open');
    drawer.setAttribute('aria-hidden','false');
    scrim.classList.add('show');
    scrim.setAttribute('aria-hidden','false');
    document.body.style.overflow='hidden'; // scroll lock
  }
  function closeDrawer(){
    drawer.classList.remove('open');
    drawer.setAttribute('aria-hidden','true');
    scrim.classList.remove('show');
    scrim.setAttribute('aria-hidden','true');
    document.body.style.overflow='';
  }
  menuBtn.addEventListener('click', openDrawer);
  scrim.addEventListener('click', closeDrawer);
  window.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeDrawer(); });

  /* ---------- Keep review hooks working ---------- */
  document.getElementById('leaveReview').addEventListener('click', (e)=>{ e.preventDefault(); alert('Hook this to your reviews form URL.'); });
  document.getElementById('leaveReviewRail').addEventListener('click', (e)=>{ e.preventDefault(); openDrawer(); });

  /* ---------- Language UI ---------- */
  const lang = document.getElementById("lang");
  const langBtn = document.getElementById("langBtn");
  const langNow = document.getElementById("langNow");
  const codeMap = {"English":"EN","Italiano":"IT","Deutsch":"DE","Español":"ES","Français":"FR","Português":"PT","Nederlands":"NL","Română":"RO","Shqip":"SQ","Türkçe":"TR","中文":"中文","日本語":"日本語"};
  document.getElementById("langMenu").querySelectorAll(".lang-item").forEach(li=>{
    li.addEventListener("click", ()=>{ langNow.textContent = codeMap[li.dataset.lang] || "EN"; });
  });
  let hoverTimer=null;
  lang.addEventListener("mouseenter", ()=>{ clearTimeout(hoverTimer); lang.classList.add("open"); });
  lang.addEventListener("mouseleave", ()=>{ hoverTimer=setTimeout(()=>lang.classList.remove("open"),150); });
  langBtn.addEventListener("click", ()=>{ lang.classList.toggle("open"); });

  /* ---------- Demo content ---------- */
  const demo = {
    summary: [
      "This contract is generally favorable with low overall risk, but several timing and remedy definitions could be tightened to avoid avoidable confusion between the parties.",
      "Payment schedule and termination rights are presented in clear, plain language; still, a couple of legacy phrases can be simplified so non-lawyers can follow without re-reading.",
      "Watch late-fee compounding and define 'material breach' with an objective test so everyday admin delays don’t escalate into disputes."
    ],
    risk: { value: 25, note: "Termination, dispute handling and scope changes need to be tightened a bit better." },
    clarity: { value: 80, note: "Some provisions are thin on definitions which reduces predictability in changes." },
    clauses: [
      "Payment Terms: Net 30 with 2% per month late fee; add a short grace period and a cap so charges remain predictable.",
      "Scope of Work: Deliverables listed in Schedule A; include acceptance criteria so approvals are objective.",
      "IP & Licensing: Client owns final assets; creator keeps tools, methods and pre-existing know-how.",
      "Termination: 30-day convenience; immediate for cause. Add a ten-day cure for minor issues to prevent accidental termination.",
      "Confidentiality: Standard carve-outs (public information, independently developed) and reasonable survival period.",
      "Scope of Work: Deliverables listed in Schedule A; include acceptance criteria so approvals are objective.",
      "IP & Licensing: Client owns final assets; creator keeps tools, methods and pre-existing know-how and add a short grace period and a cap."
    ],
    issues: [
      "Late-fee compounding escalates costs on long delays; switch to simple interest with a reasonable cap to prevent outsized penalties.",
      "Indemnity is one-sided and uncapped; replace with mutual indemnity and add a commercial cap tied to fees for proportional risk.",
      "Undefined cure periods allow immediate termination for minor faults; add a standard 10-day cure for non-critical breaches.",
      "Ambiguous definition of “material breach” invites disputes; specify an objective test and carve-out for trivial delays.",
      "Scope changes lack a written change-order process; require signed amendments with impact on price/timeline captured."
    ],
    suggestions: [
      "Add objective acceptance criteria and a short user-testing window for each milestone so sign-off is clear and quick.",
      "Insert a 5–7 day grace period before late fees accrue and convert compounding to simple interest with a total cap.",
      "Define “material breach” and include a standard ten-day cure (except for true emergencies) to minimize unnecessary escalations."
    ],
    meters:{ professionalism:95, confidence:75, favorability:75, deadline:18 }
  };

  const $ = s => document.querySelector(s);
  const cssVar = v => getComputedStyle(document.documentElement).getPropertyValue(v).trim();
  const between = (v,min,max)=>Math.max(min,Math.min(v,max));
  const addP = (el, t)=>{const p=document.createElement('p');p.textContent=t;el.appendChild(p);};

  function colorFor(metric, v){
    if (metric === 'risk') { if (v<=25) return cssVar('--green'); if (v<=55) return cssVar('--orange'); return cssVar('--red'); }
    if (metric === 'clarity') { if (v>=80) return cssVar('--green'); if (v>=45) return cssVar('--orange'); return cssVar('--red'); }
    if (metric === 'deadline') { if (v<=25) return cssVar('--green'); if (v<=75) return cssVar('--orange'); return cssVar('--red'); }
    if (v>=76) return cssVar('--green'); if (v>=50) return cssVar('--orange'); return cssVar('--red');
  }

  /* Summary */
  const sBox=$("#summaryText"); sBox.innerHTML="";
  (Array.isArray(demo.summary)?demo.summary:[String(demo.summary)]).forEach(t=>addP(sBox,t));

  function listTo(id, arr){ const el=$(id); el.innerHTML=""; (arr&&arr.length?arr:[""]).forEach(t=>addP(el,t)); }
  listTo("#clausesList", demo.clauses);

  /* Issues */
  (function(){ const el=$("#issuesList"); el.innerHTML=""; (demo.issues||[]).forEach(t=>{const li=document.createElement('li'); li.textContent=t; el.appendChild(li);}); })();
  listTo("#suggestionsList", demo.suggestions);

  /* Donuts */
  function setArc(arcEl, metric, value, valEl, noteEl, note){
    const v = between(value||0, 0, 100);
    const rr = parseFloat(arcEl.getAttribute('r')) || 74;
    const circ = 2*Math.PI*rr;
    arcEl.style.stroke = colorFor(metric, v);
    arcEl.style.strokeDasharray = circ;
    arcEl.style.strokeDashoffset = circ;
    requestAnimationFrame(()=>{ arcEl.style.transition="stroke-dashoffset 1.8s ease"; arcEl.style.strokeDashoffset = circ * (1 - v/100); });
    if (valEl) valEl.textContent = v + "%";
    if (noteEl) noteEl.textContent = note || "";
  }
  setArc($("#riskArc"), 'risk', demo.risk?.value ?? 0, $("#riskVal"), $("#riskNote"), demo.risk?.note);
  setArc($("#clarArc"), 'clarity', demo.clarity?.value ?? 0, $("#clarVal"), $("#clarNote"), demo.clarity?.note);

  /* Meters */
  function setMeter(fill, label, metric, value){
    const v = between(value||0, 0, 100);
    label.textContent = v + "%";
    fill.style.background = colorFor(metric, v);
    requestAnimationFrame(()=>{ fill.style.width = v + "%"; });
  }
  setMeter($("#confFill"), $("#confVal"), 'professionalism', demo.meters?.professionalism ?? 95);
  setMeter($("#favFill"), $("#favVal"), 'favorability', demo.meters?.favorability ?? 75);
  setMeter($("#deadFill"), $("#deadVal"), 'deadline',    demo.meters?.deadline ?? 0);

  /* Score Checker (80% pointer) */
  (function(){
    const v = 80;
    setArc($("#scoreArc"), 'confidence', v);
    $("#scorePct").textContent = v + "%";
    $("#scoreInd").style.left = "calc(80% - 1.5px)";
  })();

  /* Right-side Confidence bar */
  setMeter($("#conf2Fill"), $("#conf2Val"), 'confidence', demo.meters?.confidence ?? 0);

  /* Reveal sequencing */
  window.addEventListener('load', () => {
    ["#summaryCard","#riskCard","#clarCard"].forEach(sel => { const el=$(sel); if(el){el.classList.add('fade-in');}});
    setTimeout(()=>["#profCard","#favCard","#deadCard","#issuesCard","#clausesCard"].forEach(sel=>{const el=$(sel); if(el){el.classList.add('fade-in');}}), 180);
  });
  const io = new IntersectionObserver((entries)=>{
    entries.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add('fade-in'); io.unobserve(e.target); }});
  }, { threshold: 0.18 });
  ["#suggestionsCard","#scoreCard","#confRightCard"].forEach(sel=>{ const el=$(sel); if(el){ io.observe(el); } });

  /* Bottom CTA + footer reveal */
  const dlWrap=$("#dlWrap"), showThresholdPx=300;
  function nearBottom(){
    const scrolledFromBottom=document.documentElement.scrollHeight-(window.scrollY+window.innerHeight);
    const show=scrolledFromBottom<=showThresholdPx;
    dlWrap.style.display=show?"flex":"none";
    if(show) dlWrap.classList.add('fade-in');
  }
  window.addEventListener("scroll", nearBottom, {passive:true});
  window.addEventListener("load", nearBottom);

  /* Modal + PDF */
  const modal=$("#emailModal"), openModal=()=>modal.style.display="flex", closeModal=()=>modal.style.display="none";
  $("#downloadBtn").addEventListener("click", openModal);
  $("#emailCancel").addEventListener("click", closeModal);
  function validEmail(e){ return /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test((e||"").trim()); }
  $("#emailSubmit").addEventListener("click", async ()=>{
    const email=$("#emailInput").value||"", err=$("#emailErr");
    if(!validEmail(email)){ err.style.display="block"; return; }
    err.style.display="none";
    await generatePDF("Report", demo);
    closeModal();
  });

  async function generatePDF(title, d){
    const { jsPDF } = window.jspdf;
    const doc=new jsPDF({ unit:"pt", format:"a4" });
    const pageW=doc.internal.pageSize.getWidth();
    const margin=48, width=pageW-margin*2, lh=18;

    doc.setFillColor(28,27,34); doc.rect(0,0,pageW,80,'F');
    doc.setTextColor(255,255,255); doc.setFont("helvetica","normal"); doc.setFontSize(18);
    doc.text("SignSense — Contract Analysis Report", margin, 48);

    let y=100;
    const date=new Date().toLocaleString(); doc.setFontSize(10); doc.setTextColor(189,189,189);
    doc.text(`Generated: ${date}`, margin, y); y+=lh*1.6;

    y=section("Summary", y); y=bullets(d.summary, y);
    y=section(`Risk Level: ${d.risk?.value ?? 0}%`, y); y=paragraph(d.risk?.note || "", y);
    y=section(`Clause Clarity: ${d.clarity?.value ?? 0}%`, y); y=paragraph(d.clarity?.note || "", y);
    y=section("Main Clauses", y); y=bullets(d.clauses, y);
    y=section("Potential Issues", y); y=bullets(d.issues, y);
    y=section("Smart Suggestions", y); y=bullets(d.suggestions, y);
    doc.save("SignSense_Report.pdf");

    function section(t,y){ if(y>780){ doc.addPage(); y=64; } doc.setFont("helvetica","normal"); doc.setTextColor(255,255,255); doc.setFontSize(12); doc.text(t, margin, y); return y+12; }
    function paragraph(text,y){ if(!text) return y; doc.setFont("helvetica","normal"); doc.setTextColor(189,189,189); doc.setFontSize(11); let lines=doc.splitTextToSize(text,width); lines.forEach(line=>{ if(y>780){doc.addPage(); y=64;} doc.text(line, margin, y); y+=lh;}); return y; }
    function bullets(arr,y){ const list=Array.isArray(arr)?arr:[]; doc.setFont("helvetica","normal"); doc.setTextColor(189,189,189); doc.setFontSize(11);
      list.forEach(t=>{ const lines=doc.splitTextToSize(String(t),width-12);
        if(y>780){doc.addPage(); y=64;} doc.text("•", margin, y);
        lines.forEach((line,i)=>{ if(i===0){doc.text(line, margin+12, y);} else { y+=lh; doc.text(line, margin+12, y);} });
        y+=lh;
      }); return y;
    }
  }
})();
</script>
</body>
</html>
